import*as e from"@dropins/tools/event-bus.js";import*as t from"@dropins/tools/fetch-graphql.js";export const id=34;export const ids=[34];export const modules={3884:(e,t,r)=>{r.d(t,{KG:()=>d,QN:()=>s,iM:()=>u});var n=r(7218),i=r(3584),a=r(764);function o(e,t,r,n,i,a,o){try{var l=e[a](o),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,i)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function l(e){o(a,n,i,l,s,"next",e)}function s(e){o(a,n,i,l,s,"throw",e)}l(void 0)}))}}var s=function(){var e=l((function*(e){var t=n.K.cartId;if(!t)throw new Error("No cart ID found");if(!e)throw new Error("No address parameter found");var{countryCode:r,postcode:o,region:l}=e;return(0,i.CA)("\n  mutation ESTIMATE_SHIPPING_METHODS_MUTATION(\n    $cartId: String!\n    $address: EstimateAddressInput!\n  ) {\n    estimateShippingMethods(\n      input: {\n        cart_id: $cartId\n        address: $address\n      }\n    ) {\n      amount {\n        currency\n        value\n      }\n      error_message\n    }\n  }\n",{variables:{cartId:t,address:{country_code:r||"US",postcode:o||"",region:{region_code:(null==l?void 0:l.code)||""}}}}).then((e=>{var{errors:t,data:r}=e;if(t)return(0,a.H)(t);var n=r.estimateShippingMethods;return 0===n.length?null:n.find((e=>!e.error_message))}))}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=l((function*(){return(0,i.CA)("\nquery COUNTRIES_QUERY {\n  countries {\n    label: full_name_locale\n    id\n  }\n  storeConfig {\n    defaultCountry: default_country\n  }\n}\n",{}).then((e=>{var t,r,{errors:n,data:i}=e;if(n)return(0,a.H)(n);var o=(null==i||null===(t=i.countries)||void 0===t?void 0:t.sort(((e,t)=>e.label.localeCompare(t.label))))||[],l=(null==i||null===(r=i.storeConfig)||void 0===r?void 0:r.defaultCountry)||"US";return o.forEach((e=>{e.isDefaultCountry=e.id===l})),o}))}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=l((function*(e){return(0,i.CA)("\nquery REGIONS_QUERY($id: String) {\n  country(id: $id) {\n    available_regions {\n      code\n\t\t\tname\n    }\n  }\n}\n",{variables:{id:e}}).then((e=>{var t,{errors:r,data:n}=e;return r?(0,a.H)(r):(null==n||null===(t=n.country)||void 0===t?void 0:t.available_regions)||[]}))}));return function(t){return e.apply(this,arguments)}}()},3155:(e,t,r)=>{r.d(t,{W:()=>R,c:()=>R});var n=r(2796),i=r(884),a=r(8122),o=r(2460),l=r(4944),s=r(5536),d=r.n(s),u=r(7008),c=r.n(u),p=r(1496),m=r.n(p),y=r(9356),v=r.n(y),h=r(9904),g=r.n(h),f=r(7024),b={attributes:{"data-dropin":"storefront-cart","data-sdk":"0.23.0-alpha1067"},styleTagTransform:function(e,t){window._loadedStyles=window._loadedStyles??{};const r=e?.match(/^\.dropin-(\w+)/)?.[1],n=t.getAttribute("data-sdk"),i=r?`sdk/${r}`:t.getAttribute("data-dropin");t.setAttribute("data-dropin",i),t.removeAttribute("data-sdk");const a=window._loadedStyles[i];if(a){const i=function(e,t){const[r,n]=e.split("-"),[i,a]=t.split("-"),o=[...r.split("."),n],l=[...i.split("."),a],s=parseInt(o[0],10),d=parseInt(l[0],10);if(s!==d)return s>d?e:t;const u=parseInt(o[1],10),c=parseInt(l[1],10);if(u!==c)return u>c?e:t;const p=parseInt(o[2],10),m=parseInt(l[2],10);if(p!==m)return p>m?e:t;if(o[3]&&l[3]){const r=/(alpha|beta)(.*)/,n=o[3].match(r),i=l[3].match(r),a=n[1],s=i[1],d=parseInt(n[2],10),u=parseInt(i[2],10);if(a===s)return d>u?e:t;if("alpha"===a&&"beta"===s)return t;if("beta"===a&&"alpha"===s)return e}return o[3]?t:e}(n,a.sdk);if(!r||r&&i===a.sdk){const t=a.style.textContent;a.style.textContent=`${t}\n/* --- MERGED --- */\n${e}`}else r&&i!==a.sdk&&(a.style.textContent=`/* --- UPGRADED --- */\n${e}`);return void t.remove()}t.textContent=e,window._loadedStyles[i]={sdk:n,core:r,style:t};const o=document.querySelector("head"),{lastDropinStyleInjected:l,lastSDKStyleInjected:s}=window._loadedStyles;r?(s?o.insertBefore(t,s.nextSibling):o.insertBefore(t,o.firstChild),window._loadedStyles.lastSDKStyleInjected=t):(l?o.insertBefore(t,l.nextSibling):s?o.insertBefore(t,s.nextSibling):o.insertBefore(t,o.firstChild),window._loadedStyles.lastDropinStyleInjected=t)}};b.setAttributes=v(),b.insert=m().bind(null,"head"),b.domAPI=c(),b.insertStyleElement=g();d()(f.c,b);f.c&&f.c.locals&&f.c.locals;var S=r(4772),C=r(8920),O=r(6360),w=r(7912),j=r(2872),P=r(8412),x=["className","orderSummaryData","routeCheckout","priceSummaryApi","allowEstimateShipping"];function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var k=e=>{var t,r,n,i,{className:a,orderSummaryData:s,routeCheckout:d,priceSummaryApi:u,allowEstimateShipping:c=!0}=e,p=D(e,x),{loading:m,regionsLoading:y,countries:v,regions:h,selectedCountry:g,selectedRegion:f,selectedZip:b,estimatedDestinationText:I,estimatedShippingPrice:E,handleCountrySelected:k,handleEstimateShipping:_}=u,F=(0,o.cF)({applyButton:"Cart.PriceSummary.estimatedShippingForm.apply.label",checkout:"Cart.PriceSummary.checkout",countryField:"Cart.PriceSummary.estimatedShippingForm.country.placeholder",discountedPrice:"Cart.CartItem.discountedPrice",download:"Cart.CartItem.download",freeShipping:"Cart.PriceSummary.freeShipping",heading:"Cart.Cart.heading",message:"Cart.CartItem.message",regularPrice:"Cart.CartItem.regularPrice",recipient:"Cart.CartItem.recipient",sender:"Cart.CartItem.sender",stateField:"Cart.PriceSummary.estimatedShippingForm.state.placeholder",taxToBeDetermined:"Cart.PriceSummary.taxToBeDetermined",zipField:"Cart.PriceSummary.estimatedShippingForm.zip.placeholder",file:"Cart.CartItem.file",files:"Cart.CartItem.files"});return(0,P.im)("div",T(T({},p),{},{className:(0,l.i)(["cart-order-summary",a]),children:(0,P.im)(S.A,{className:"cart-cart__price-summary","data-testid":"price-summary",loading:m,heading:"Order Summary",total:{price:(0,P.im)(C.Y,{amount:null==s?void 0:s.total.value,currency:null==s?void 0:s.total.currency}),estimated:!0},subTotal:{price:(0,P.im)(C.Y,{"data-testid":"subtotal",amount:null==s||null===(t=s.subtotal.excludingTax)||void 0===t?void 0:t.value,currency:null==s||null===(r=s.subtotal.excludingTax)||void 0===r?void 0:r.currency})},shipping:null!=s&&s.isVirtual?void 0:c?{price:0==(null==E?void 0:E.amount)?(0,P.im)("span",{"data-testId":"free-shipping",children:F.freeShipping}):E?(0,P.im)(C.Y,T({},E)):(0,P.im)("span",{children:F.taxToBeDetermined}),estimated:!0,countryField:(0,P.im)(O.q,{name:"shippingCountry",placeholder:F.countryField,value:g,variant:"primary",options:v,handleSelect:k,"data-testid":"estimate-shipping-country-selector"}),stateField:h.length>0?(0,P.im)(O.q,{name:"shippingState",placeholder:F.stateField,variant:"primary",options:h,value:f,"data-testid":"estimate-shipping-state-selector",disabled:y}):(0,P.im)(w.E,{"aria-label":F.stateField,name:"shippingState",placeholder:F.stateField,variant:"primary",value:f,disabled:y,"data-testid":"estimate-shipping-state-input",maxLength:50}),zipField:(0,P.im)(w.E,{"aria-label":F.zipField,name:"shippingZip",placeholder:F.zipField,variant:"primary","data-testid":"estimate-shipping-zip-input",value:b,maxLength:12}),estimateButton:(0,P.im)(j.q,{variant:"secondary","data-testid":"estimate-shipping-apply-button","aria-label":F.applyButton,children:F.applyButton}),destinationText:I||F.taxToBeDetermined,onEstimate:_}:(null==s?void 0:s.shipping)&&{price:(0,P.im)(C.Y,{"data-testid":"shipping-total",amount:null==s?void 0:s.shipping.value,currency:null==s?void 0:s.shipping.currency})},taxTotal:{price:null!=s&&s.totalTax?(0,P.im)(C.Y,{"data-testid":"tax-total",amount:null==s||null===(n=s.totalTax)||void 0===n?void 0:n.value,currency:null==s||null===(i=s.totalTax)||void 0===i?void 0:i.currency}):(0,P.im)("span",{"data-testid":"tax-total",children:F.taxToBeDetermined}),estimated:!0},primaryAction:d?(0,P.im)(j.q,{"data-testid":"checkout-button",variant:"primary",href:d({cartId:s.id}),children:F.checkout}):void 0,discounts:null==s?void 0:s.appliedDiscounts.map((e=>({label:e.label,price:(0,P.im)(C.Y,{"data-testid":"summary-discount-total",amount:-e.amount.value,currency:e.amount.currency,sale:!0})})))})}))},_=r(6696),F=["routeCheckout","allowEstimateShipping"];function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var R=e=>{var t,{routeCheckout:r,allowEstimateShipping:o=!0}=e,l=Y(e,F),[s,d]=(0,n.oT)(),{loading:u,regionsLoading:c,countries:p,regions:m,selectedCountry:y,selectedRegion:v,selectedZip:h,estimatedDestinationText:g,estimatedShippingPrice:f,handleCountrySelected:b,handleEstimateShipping:S}=(0,i.u)();(0,n.YB)((()=>{var e=a.events.on("cart/data",(e=>{var t;d(e);var r=null==e||null===(t=e.addresses)||void 0===t||null===(t=t.shipping)||void 0===t?void 0:t[0];if(r){var{countryCode:n,regionCode:i,zipCode:a}=r;S({shippingCountry:n,shippingState:i,shippingZip:a})}}),{eager:!0}),t=a.events.on("checkout/data",(e=>{console.log("order summary handling checkout data changes"),(0,_.K)().then((e=>{var t,r,n;d(e),S({shippingCountry:(null==e||null===(t=e.addresses)||void 0===t||null===(t=t.shipping)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.countryCode)||"US",shippingState:null==e||null===(r=e.addresses)||void 0===r||null===(r=r.shipping)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.regionCode,shippingZip:null==e||null===(n=e.addresses)||void 0===n||null===(n=n.shipping)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.zipCode})}))}),{eager:!0});return()=>{null==e||e.off(),null==t||t.off()}}),[S]);var C=null!==(t=null==s?void 0:s.totalQuantity)&&void 0!==t&&t?(0,P.im)(k,B({orderSummaryData:s,routeCheckout:r,priceSummaryApi:{loading:u,regionsLoading:c,countries:p,regions:m,selectedCountry:y,selectedRegion:v,selectedZip:h,estimatedDestinationText:g,estimatedShippingPrice:f,handleCountrySelected:b,handleEstimateShipping:S},allowEstimateShipping:o},l)):void 0;return(0,P.im)("div",B(B({},l),{},{children:C}))}},884:(e,t,r)=>{r.d(t,{u:()=>a});var n=r(2796),i=r(3884),a=()=>{var[e,t]=(0,n.oT)([]),[r,a]=(0,n.oT)("US"),[o,l]=(0,n.oT)(""),[s,d]=(0,n.oT)(""),[u,c]=(0,n.oT)([]),[p,m]=(0,n.oT)(!1),[y,v]=(0,n.oT)(),[h,g]=(0,n.oT)(""),[f,b]=(0,n.oT)(!1),S=(0,n.kZ)((e=>{var{shippingCountry:t,shippingState:r="",shippingZip:n=""}=e,o={countryCode:t,postcode:n,region:{code:r}};b(!0),(0,i.QN)(o).then((e=>{e&&(v({amount:e.amount.value,currency:e.amount.currency}),a(t),l(r),d(n),g(r||n||t))})).finally((()=>{b(!1)}))}),[]);return(0,n.YB)((()=>{(0,i.KG)().then((e=>{var r="US",n=e.map((e=>(e.isDefaultCountry&&(r=e.id),{text:e.label,value:e.id})));t(n),a(r)}))}),[]),(0,n.YB)((()=>{m(!0),(0,i.iM)(r).then((e=>{var t=e.map((e=>({text:e.name,value:e.code})));c(t)})).finally((()=>{m(!1)}))}),[r,m]),{loading:f,regionsLoading:p,estimatedDestinationText:h,countries:e,selectedCountry:r,selectedRegion:o,selectedZip:s,regions:u,estimatedShippingPrice:y,handleEstimateShipping:S,handleCountrySelected:e=>{e.preventDefault(),l(""),d("");var t=e.target.value;a(t)}}}},7024:(e,t,r)=>{r.d(t,{c:()=>l});var n=r(6008),i=r.n(n),a=r(2076),o=r.n(a)()(i());o.push([e.id,"\n",""]);const l=o},8122:(t,r,n)=>{t.exports=(e=>{var t={};return n.d(t,e),t})({events:()=>e.events})},8616:(e,r,n)=>{e.exports=(e=>{var t={};return n.d(t,e),t})({FetchGraphQL:()=>t.FetchGraphQL})}};import r from"../runtime.js";import*as n from"../800.js";r.C(n);import*as i from"../848.js";r.C(i);import*as a from"../464.js";r.C(a);import*as o from"../436.js";r.C(o);import*as l from"./OrderSummary.js";r.C(l);var s,d=(s=3155,r(r.s=s)),u=d.W,c=d.c;export{u as OrderSummary,c as default};